<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collaboration Arrangement Builder</title>
    <style>
        :root {
            --primary: #4a6fa5;
            --secondary: #6e9887;
            --background: #f9f9f9;
            --text: #333;
            --light: #ffffff;
            --shadow: rgba(0, 0, 0, 0.1);
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text);
            background-color: var(--background);
            margin: 0;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: var(--light);
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 12px var(--shadow);
        }
        
        h1, h2, h3 {
            color: var(--primary);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .form-section {
            margin-bottom: 30px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            margin-bottom: 20px;
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #3a5a8a;
        }
        
        .danger {
            background-color: #e74c3c;
        }
        
        .danger:hover {
            background-color: #c0392b;
        }
        
        .success {
            background-color: var(--secondary);
        }
        
        .success:hover {
            background-color: #5a8074;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .section-list {
            list-style: none;
            padding: 0;
        }
        
        .section-item {
            background-color: #f5f7fa;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 4px;
            border-left: 4px solid var(--primary);
        }
        
        .section-controls {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 10px;
        }
        
        .section-controls button {
            padding: 5px 10px;
            font-size: 14px;
        }
        
        .preview-area {
            background-color: #f5f7fa;
            padding: 20px;
            border-radius: 4px;
            margin-top: 30px;
            white-space: pre-wrap;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background-color: #eee;
            margin-right: 5px;
            border-radius: 4px 4px 0 0;
        }
        
        .tab.active {
            background-color: var(--primary);
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .participants-section {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .participant {
            flex: 1;
            padding: 15px;
            background-color: #f5f7fa;
            border-radius: 4px;
        }
        
        @media (max-width: 768px) {
            .participants-section {
                flex-direction: column;
            }
            
            .button-group {
                flex-direction: column;
            }
        }
        
        .hidden {
            display: none;
        }
        
        #agreementOutput {
            margin-top: 30px;
            padding: 20px;
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Collaboration Arrangement Builder</h1>
            <p>Create clear arrangements between two people with customizable terms</p>
        </div>
        
        <div class="tabs">
            <div class="tab active" data-tab="setup">1. Basic Setup</div>
            <div class="tab" data-tab="details">2. Details</div>
            <div class="tab" data-tab="conditions">3. Conditions</div>
            <div class="tab" data-tab="preview">4. Preview</div>
        </div>
        
        <div id="setupTab" class="tab-content active">
            <h2>Basic Information</h2>
            
            <div class="form-section">
                <label for="arrangementTitle">Title of Arrangement</label>
                <input type="text" id="arrangementTitle" placeholder="e.g., Room Sharing Arrangement, Project Collaboration">
            </div>
            
            <div class="form-section">
                <label for="arrangementPurpose">Purpose of this Arrangement</label>
                <textarea id="arrangementPurpose" placeholder="Describe why you're creating this arrangement and what both parties hope to achieve..."></textarea>
            </div>
            
            <h2>Participants</h2>
            <div class="participants-section">
                <div class="participant">
                    <h3>First Person</h3>
                    <label for="firstPersonName">Full Name</label>
                    <input type="text" id="firstPersonName">
                    
                    <label for="firstPersonContact">Contact Information</label>
                    <input type="text" id="firstPersonContact" placeholder="Email or phone number">
                </div>
                
                <div class="participant">
                    <h3>Second Person</h3>
                    <label for="secondPersonName">Full Name</label>
                    <input type="text" id="secondPersonName">
                    
                    <label for="secondPersonContact">Contact Information</label>
                    <input type="text" id="secondPersonContact" placeholder="Email or phone number">
                </div>
            </div>
            
            <div class="form-section">
                <label for="effectiveDate">Effective Date</label>
                <input type="date" id="effectiveDate">
            </div>
            
            <div class="form-section">
                <label for="duration">Duration</label>
                <select id="duration">
                    <option value="specific">Specific Time Period</option>
                    <option value="ongoing">Ongoing with Notice</option>
                    <option value="completion">Until Completion</option>
                </select>
                
                <div id="specificDuration">
                    <label for="endDate">End Date</label>
                    <input type="date" id="endDate">
                </div>
                
                <div id="ongoingDuration" class="hidden">
                    <label for="noticePeriod">Notice Period (days)</label>
                    <input type="number" id="noticePeriod" min="1" value="30">
                </div>
                
                <div id="completionCriteria" class="hidden">
                    <label for="completionDescription">Completion Criteria</label>
                    <textarea id="completionDescription" placeholder="Describe what constitutes completion of this arrangement..."></textarea>
                </div>
            </div>
            
            <div class="button-group">
                <button class="next-tab" data-next="details">Continue to Details</button>
            </div>
        </div>
        
        <div id="detailsTab" class="tab-content">
            <h2>Arrangement Details</h2>
            
            <div class="form-section">
                <label for="responsibilitiesSection">Responsibilities</label>
                <div class="custom-section" id="responsibilitiesSection">
                    <ul class="section-list" id="responsibilitiesList"></ul>
                    <div class="add-section-form">
                        <label for="responsibilityPerson">Person</label>
                        <select id="responsibilityPerson">
                            <option value="first">First Person</option>
                            <option value="second">Second Person</option>
                            <option value="both">Both People</option>
                        </select>
                        
                        <label for="responsibilityDescription">Description</label>
                        <textarea id="responsibilityDescription" placeholder="Describe the responsibility..."></textarea>
                        
                        <button type="button" id="addResponsibility" class="success">Add Responsibility</button>
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <label for="resourcesSection">Resources & Contributions</label>
                <div class="custom-section" id="resourcesSection">
                    <ul class="section-list" id="resourcesList"></ul>
                    <div class="add-section-form">
                        <label for="resourcePerson">Person</label>
                        <select id="resourcePerson">
                            <option value="first">First Person</option>
                            <option value="second">Second Person</option>
                            <option value="both">Both People</option>
                        </select>
                        
                        <label for="resourceType">Type</label>
                        <select id="resourceType">
                            <option value="financial">Financial</option>
                            <option value="material">Materials/Equipment</option>
                            <option value="space">Space/Location</option>
                            <option value="service">Service/Labor</option>
                            <option value="other">Other</option>
                        </select>
                        
                        <label for="resourceDescription">Description</label>
                        <textarea id="resourceDescription" placeholder="Describe the resource or contribution..."></textarea>
                        
                        <button type="button" id="addResource" class="success">Add Resource</button>
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <label for="schedulesSection">Schedules & Timelines</label>
                <div class="custom-section" id="schedulesSection">
                    <ul class="section-list" id="schedulesList"></ul>
                    <div class="add-section-form">
                        <label for="scheduleTitle">Title</label>
                        <input type="text" id="scheduleTitle" placeholder="e.g., Weekly Meetings, Payment Schedule">
                        
                        <label for="scheduleDescription">Description</label>
                        <textarea id="scheduleDescription" placeholder="Describe the schedule or timeline..."></textarea>
                        
                        <button type="button" id="addSchedule" class="success">Add Schedule</button>
                    </div>
                </div>
            </div>
            
            <div class="button-group">
                <button class="prev-tab" data-prev="setup">Back to Setup</button>
                <button class="next-tab" data-next="conditions">Continue to Conditions</button>
            </div>
        </div>
        
        <div id="conditionsTab" class="tab-content">
            <h2>Arrangement Conditions</h2>
            
            <div class="form-section">
                <label for="termsSection">Special Terms</label>
                <div class="custom-section" id="termsSection">
                    <ul class="section-list" id="termsList"></ul>
                    <div class="add-section-form">
                        <label for="termTitle">Title</label>
                        <input type="text" id="termTitle" placeholder="e.g., Noise Limitations, Shared Space Rules">
                        
                        <label for="termDescription">Description</label>
                        <textarea id="termDescription" placeholder="Describe the term..."></textarea>
                        
                        <button type="button" id="addTerm" class="success">Add Term</button>
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <label for="modificationProcess">Modification Process</label>
                <textarea id="modificationProcess" placeholder="Describe how this arrangement can be modified if needed...">Any modification to this arrangement requires written agreement from both parties.</textarea>
            </div>
            
            <div class="form-section">
                <label for="communicationMethod">Communication Method</label>
                <textarea id="communicationMethod" placeholder="How will the parties communicate about this arrangement?">Both parties agree to communicate openly about any issues related to this arrangement. Primary communication will be through email, with in-person discussions as needed.</textarea>
            </div>
            
            <div class="form-section">
                <label for="endingProcess">Ending Process</label>
                <textarea id="endingProcess" placeholder="How can this arrangement be ended by either party?">Either party may end this arrangement by providing written notice according to the specified notice period. Both parties will fulfill any remaining obligations as outlined in this arrangement.</textarea>
            </div>
            
            <div class="button-group">
                <button class="prev-tab" data-prev="details">Back to Details</button>
                <button class="next-tab" data-next="preview">Continue to Preview</button>
            </div>
        </div>
        
        <div id="previewTab" class="tab-content">
            <h2>Preview & Finalize</h2>
            
            <button id="generatePreview" class="success">Generate Preview</button>
            
            <div id="agreementOutput" class="hidden">
                <!-- Generated arrangement will appear here -->
            </div>
            
            <div class="button-group">
                <button class="prev-tab" data-prev="conditions">Back to Conditions</button>
                <button id="downloadPDF" class="success hidden">Download as PDF</button>
                <button id="copyText" class="success">Copy Text</button>
                <button id="resetForm" class="danger">Start Over</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Tab navigation
            const tabs = document.querySelectorAll('.tab');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabName = tab.getAttribute('data-tab');
                    
                    // Update active tab
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    // Show active content
                    tabContents.forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(tabName + 'Tab').classList.add('active');
                });
            });
            
            // Next/Previous buttons
            document.querySelectorAll('.next-tab').forEach(button => {
                button.addEventListener('click', () => {
                    const nextTab = button.getAttribute('data-next');
                    document.querySelector(`.tab[data-tab="${nextTab}"]`).click();
                });
            });
            
            document.querySelectorAll('.prev-tab').forEach(button => {
                button.addEventListener('click', () => {
                    const prevTab = button.getAttribute('data-prev');
                    document.querySelector(`.tab[data-tab="${prevTab}"]`).click();
                });
            });
            
            // Duration type selection
            const durationSelect = document.getElementById('duration');
            const specificDuration = document.getElementById('specificDuration');
            const ongoingDuration = document.getElementById('ongoingDuration');
            const completionCriteria = document.getElementById('completionCriteria');
            
            durationSelect.addEventListener('change', function() {
                specificDuration.classList.add('hidden');
                ongoingDuration.classList.add('hidden');
                completionCriteria.classList.add('hidden');
                
                if (this.value === 'specific') {
                    specificDuration.classList.remove('hidden');
                } else if (this.value === 'ongoing') {
                    ongoingDuration.classList.remove('hidden');
                } else if (this.value === 'completion') {
                    completionCriteria.classList.remove('hidden');
                }
            });
            
            // Add Responsibility
            const responsibilitiesList = document.getElementById('responsibilitiesList');
            const addResponsibilityBtn = document.getElementById('addResponsibility');
            
            addResponsibilityBtn.addEventListener('click', function() {
                const person = document.getElementById('responsibilityPerson').value;
                const description = document.getElementById('responsibilityDescription').value;
                if (!description) return;
                
                const personText = person === 'first' ? 
                    document.getElementById('firstPersonName').value || 'First Person' : 
                    person === 'second' ? 
                        document.getElementById('secondPersonName').value || 'Second Person' : 
                        'Both Parties';
                
                const li = document.createElement('li');
                li.className = 'section-item';
                li.innerHTML = `
                    <strong>${personText}</strong>: ${description}
                    <div class="section-controls">
                        <button class="danger delete-item">Remove</button>
                    </div>
                `;
                
                responsibilitiesList.appendChild(li);
                document.getElementById('responsibilityDescription').value = '';
                
                // Add delete functionality
                li.querySelector('.delete-item').addEventListener('click', function() {
                    li.remove();
                });
            });
            
            // Add Resource
            const resourcesList = document.getElementById('resourcesList');
            const addResourceBtn = document.getElementById('addResource');
            
            addResourceBtn.addEventListener('click', function() {
                const person = document.getElementById('resourcePerson').value;
                const type = document.getElementById('resourceType').value;
                const description = document.getElementById('resourceDescription').value;
                if (!description) return;
                
                const personText = person === 'first' ? 
                    document.getElementById('firstPersonName').value || 'First Person' : 
                    person === 'second' ? 
                        document.getElementById('secondPersonName').value || 'Second Person' : 
                        'Both Parties';
                
                const typeText = type.charAt(0).toUpperCase() + type.slice(1);
                
                const li = document.createElement('li');
                li.className = 'section-item';
                li.innerHTML = `
                    <strong>${personText}</strong> - ${typeText}: ${description}
                    <div class="section-controls">
                        <button class="danger delete-item">Remove</button>
                    </div>
                `;
                
                resourcesList.appendChild(li);
                document.getElementById('resourceDescription').value = '';
                
                // Add delete functionality
                li.querySelector('.delete-item').addEventListener('click', function() {
                    li.remove();
                });
            });
            
            // Add Schedule
            const schedulesList = document.getElementById('schedulesList');
            const addScheduleBtn = document.getElementById('addSchedule');
            
            addScheduleBtn.addEventListener('click', function() {
                const title = document.getElementById('scheduleTitle').value;
                const description = document.getElementById('scheduleDescription').value;
                if (!title || !description) return;
                
                const li = document.createElement('li');
                li.className = 'section-item';
                li.innerHTML = `
                    <strong>${title}</strong>: ${description}
                    <div class="section-controls">
                        <button class="danger delete-item">Remove</button>
                    </div>
                `;
                
                schedulesList.appendChild(li);
                document.getElementById('scheduleTitle').value = '';
                document.getElementById('scheduleDescription').value = '';
                
                // Add delete functionality
                li.querySelector('.delete-item').addEventListener('click', function() {
                    li.remove();
                });
            });
            
            // Add Term
            const termsList = document.getElementById('termsList');
            const addTermBtn = document.getElementById('addTerm');
            
            addTermBtn.addEventListener('click', function() {
                const title = document.getElementById('termTitle').value;
                const description = document.getElementById('termDescription').value;
                if (!title || !description) return;
                
                const li = document.createElement('li');
                li.className = 'section-item';
                li.innerHTML = `
                    <strong>${title}</strong>: ${description}
                    <div class="section-controls">
                        <button class="danger delete-item">Remove</button>
                    </div>
                `;
                
                termsList.appendChild(li);
                document.getElementById('termTitle').value = '';
                document.getElementById('termDescription').value = '';
                
                // Add delete functionality
                li.querySelector('.delete-item').addEventListener('click', function() {
                    li.remove();
                });
            });
            
            // Generate Preview
            const generatePreviewBtn = document.getElementById('generatePreview');
            const agreementOutput = document.getElementById('agreementOutput');
            const downloadPDFBtn = document.getElementById('downloadPDF');
            
            generatePreviewBtn.addEventListener('click', function() {
                // Get basic information
                const title = document.getElementById('arrangementTitle').value || 'Collaboration Arrangement';
                const purpose = document.getElementById('arrangementPurpose').value || 'Not specified';
                const firstPersonName = document.getElementById('firstPersonName').value || 'First Person';
                const secondPersonName = document.getElementById('secondPersonName').value || 'Second Person';
                const firstPersonContact = document.getElementById('firstPersonContact').value || 'Not provided';
                const secondPersonContact = document.getElementById('secondPersonContact').value || 'Not provided';
                const effectiveDate = document.getElementById('effectiveDate').value || 'Not specified';
                
                // Format effective date
                let formattedEffectiveDate = 'Not specified';
                if (effectiveDate) {
                    const date = new Date(effectiveDate);
                    formattedEffectiveDate = date.toLocaleDateString('en-US', {
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric'
                    });
                }
                
                // Get duration information
                const durationType = document.getElementById('duration').value;
                let durationText = '';
                
                if (durationType === 'specific') {
                    const endDate = document.getElementById('endDate').value;
                    if (endDate) {
                        const date = new Date(endDate);
                        durationText = `Until ${date.toLocaleDateString('en-US', {
                            year: 'numeric', 
                            month: 'long', 
                            day: 'numeric'
                        })}`;
                    } else {
                        durationText = 'End date not specified';
                    }
                } else if (durationType === 'ongoing') {
                    const noticePeriod = document.getElementById('noticePeriod').value;
                    durationText = `Ongoing with ${noticePeriod} days notice required for termination`;
                } else if (durationType === 'completion') {
                    const completionDesc = document.getElementById('completionDescription').value;
                    durationText = `Until completion: ${completionDesc || 'Completion criteria not specified'}`;
                }
                
                // Get all responsibilities
                let responsibilitiesHtml = '';
                document.querySelectorAll('#responsibilitiesList .section-item').forEach(item => {
                    responsibilitiesHtml += `<li>${item.innerHTML.split('<div')[0]}</li>`;
                });
                
                // Get all resources
                let resourcesHtml = '';
                document.querySelectorAll('#resourcesList .section-item').forEach(item => {
                    resourcesHtml += `<li>${item.innerHTML.split('<div')[0]}</li>`;
                });
                
                // Get all schedules
                let schedulesHtml = '';
                document.querySelectorAll('#schedulesList .section-item').forEach(item => {
                    schedulesHtml += `<li>${item.innerHTML.split('<div')[0]}</li>`;
                });
                
                // Get all terms
                let termsHtml = '';
                document.querySelectorAll('#termsList .section-item').forEach(item => {
                    termsHtml += `<li>${item.innerHTML.split('<div')[0]}</li>`;
                });
                
                // Get other conditions
                const modificationProcess = document.getElementById('modificationProcess').value || 'Not specified';
                const communicationMethod = document.getElementById('communicationMethod').value || 'Not specified';
                const endingProcess = document.getElementById('endingProcess').value || 'Not specified';
                
                // Build the HTML
                const html = `
                    <h1 style="text-align: center;">${title}</h1>
                    <p style="text-align: center;"><strong>Effective Date: ${formattedEffectiveDate}</strong></p>
                    
                    <h2>Participants</h2>
                    <p><strong>First Party:</strong> ${firstPersonName} (${firstPersonContact})</p>
                    <p><strong>Second Party:</strong> ${secondPersonName} (${secondPersonContact})</p>
                    
                    <h2>Purpose</h2>
                    <p>${purpose}</p>
                    
                    <h2>Duration</h2>
                    <p>${durationText}</p>
                    
                    <h2>Responsibilities</h2>
                    ${responsibilitiesHtml ? `<ul>${responsibilitiesHtml}</ul>` : '<p>No responsibilities specified</p>'}
                    
                    <h2>Resources & Contributions</h2>
                    ${resourcesHtml ? `<ul>${resourcesHtml}</ul>` : '<p>No resources specified</p>'}
                    
                    <h2>Schedules & Timelines</h2>
                    ${schedulesHtml ? `<ul>${schedulesHtml}</ul>` : '<p>No schedules specified</p>'}
                    
                    <h2>Special Terms</h2>
                    ${termsHtml ? `<ul>${termsHtml}</ul>` : '<p>No special terms specified</p>'}
                    
                    <h2>Modification Process</h2>
                    <p>${modificationProcess}</p>
                    
                    <h2>Communication Method</h2>
                    <p>${communicationMethod}</p>
                    
                    <h2>Ending Process</h2>
                    <p>${endingProcess}</p>
                    
                    <div style="margin-top: 50px;">
                        <p>Agreed to by:</p>
                        
                        <div style="margin-top: 30px; display: flex; justify-content: space-between;">
                            <div style="width: 45%;">
                                <p>_______________________________<br>
                                ${firstPersonName}<br>
                                Date: _______________</p>
                            </div>
                            
                            <div style="width: 45%;">
                                <p>_______________________________<br>
                                ${secondPersonName}<br>
                                Date: _______________</p>
                            </div>
                        </div>
                    </div>
                `;
                
                agreementOutput.innerHTML = html;
                agreementOutput.classList.remove('hidden');
                downloadPDFBtn.classList.remove('hidden');
            });
            
            // Copy Text functionality
            document.getElementById('copyText').addEventListener('click', function() {
                if (agreementOutput.classList.contains('hidden')) {
                    alert('Please generate a preview first');
                    return;
                }
                
                // Create a temporary textarea
                const textarea = document.createElement('textarea');
                textarea.value = agreementOutput.innerText;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                
                alert('Text copied to clipboard!');
            });
            
            // Reset Form
            document.getElementById('resetForm').addEventListener('click', function() {
                if (confirm('Are you sure you want to reset the form? All your data will be lost.')) {
                    location.reload();
                }
            });
            
            // Download as PDF (placeholder - would need a proper PDF library for real implementation)
            document.getElementById('downloadPDF').addEventListener('click', function() {
                alert('To implement PDF download functionality, you would need to add a library like jsPDF or use a backend service. For now, please use the Copy Text feature.');
            });
        });
    </script>

	<script>
	// Property Sharing Extension Module
	const PropertySharingModule = {
		initialize: function() {
			// Create the new tab
			this.createTab();
			// Initialize event listeners
			this.initializeEvents();
			// Ensure proper tab navigation
			this.improveTabNavigation();
		},
		
		createTab: function() {
			// Add a new tab in the tabs section
			const tabsContainer = document.querySelector('.tabs');
			const propertyTab = document.createElement('div');
			propertyTab.className = 'tab';
			propertyTab.setAttribute('data-tab', 'property');
			propertyTab.textContent = '2.5 Space Sharing';
			
			// Insert after details tab but before conditions
			const conditionsTab = document.querySelector('.tab[data-tab="conditions"]');
			tabsContainer.insertBefore(propertyTab, conditionsTab);
			
			// Create tab content
			const propertyTabContent = document.createElement('div');
			propertyTabContent.id = 'propertyTab';
			propertyTabContent.className = 'tab-content';
			
			propertyTabContent.innerHTML = `
				<h2>Space Sharing Arrangements</h2>
				
				<div class="form-section">
					<label for="spaceType">Type of Space</label>
					<select id="spaceType">
						<option value="residential">Residential Space</option>
						<option value="commercial">Commercial Space</option>
						<option value="workspace">Workspace</option>
						<option value="storage">Storage Space</option>
						<option value="outdoor">Outdoor Space</option>
						<option value="other">Other Space Type</option>
					</select>
				</div>
				
				<div class="form-section">
					<label for="spaceDescription">Space Description</label>
					<textarea id="spaceDescription" placeholder="Describe the space being shared, including location, features, and condition..."></textarea>
				</div>
				
				<div class="form-section">
					<label for="spaceAccess">Access Details</label>
					<textarea id="spaceAccess" placeholder="Describe how and when the space can be accessed..."></textarea>
				</div>

				<div class="form-section">
					<label for="compensationDetails">Compensation Arrangement</label>
					<div class="custom-section" id="compensationDetails">
						<h3>Compensation Type</h3>
						<select id="compensationType">
							<option value="monetary">Monetary</option>
							<option value="work">Services/Work Exchange</option>
							<option value="barter">Barter/Trade</option>
							<option value="free">No Compensation</option>
							<option value="mixed">Mixed Arrangement</option>
						</select>
						
						<div id="monetaryDetails">
							<label for="paymentAmount">Amount</label>
							<input type="number" id="paymentAmount" min="0" step="0.01">
							
							<label for="paymentCurrency">Currency</label>
							<input type="text" id="paymentCurrency" value="USD">
							
							<label for="paymentFrequency">Frequency</label>
							<select id="paymentFrequency">
								<option value="weekly">Weekly</option>
								<option value="biweekly">Bi-weekly</option>
								<option value="monthly">Monthly</option>
								<option value="quarterly">Quarterly</option>
								<option value="annual">Annual</option>
								<option value="oneTime">One-time</option>
							</select>
							
							<label for="paymentDueDate">Due Date</label>
							<input type="text" id="paymentDueDate" placeholder="e.g., 1st of month, within 3 days of...">
							
							<label for="paymentMethod">Payment Method</label>
							<input type="text" id="paymentMethod" placeholder="e.g., bank transfer, cash, etc.">
						</div>
						
						<div id="workDetails" class="hidden">
							<label for="workDescription">Work Description</label>
							<textarea id="workDescription" placeholder="Describe the work or services to be provided in exchange..."></textarea>
							
							<label for="workHours">Hours/Frequency</label>
							<input type="text" id="workHours" placeholder="e.g., 10 hours weekly, 2 days per month">
						</div>
						
						<div id="barterDetails" class="hidden">
							<label for="barterDescription">Barter Description</label>
							<textarea id="barterDescription" placeholder="Describe the goods or services to be exchanged..."></textarea>
						</div>
						
						<div id="mixedDetails" class="hidden">
							<label for="mixedDescription">Mixed Arrangement Description</label>
							<textarea id="mixedDescription" placeholder="Describe the combination of monetary and non-monetary compensation..."></textarea>
						</div>
					</div>
				</div>
				
				<div class="form-section">
					<label for="maintenanceSection">Upkeep Responsibilities</label>
					<div class="custom-section" id="maintenanceSection">
						<ul class="section-list" id="maintenanceList"></ul>
						<div class="add-section-form">
							<label for="maintenanceItem">Responsibility</label>
							<input type="text" id="maintenanceItem" placeholder="e.g., Cleaning, Yard work, Repairs">
							
							<label for="maintenancePerson">Person Responsible</label>
							<select id="maintenancePerson">
								<option value="first">Space Provider</option>
								<option value="second">Space User</option>
								<option value="both">Both Parties</option>
								<option value="shared">Shared (describe below)</option>
							</select>
							
							<label for="maintenanceDescription">Details</label>
							<textarea id="maintenanceDescription" placeholder="Describe the maintenance responsibility..."></textarea>
							
							<button type="button" id="addMaintenance" class="success">Add Responsibility</button>
						</div>
					</div>
				</div>
				
				<div class="form-section">
					<label for="housingRules">Space Usage Guidelines</label>
					<textarea id="housingRules" placeholder="Describe any guidelines for using the space..."></textarea>
				</div>
				
				<div class="form-section">
					<label for="visitorsPolicy">Visitors Policy</label>
					<textarea id="visitorsPolicy" placeholder="Describe any guidelines regarding visitors..."></textarea>
				</div>
				
				<div class="form-section">
					<label for="utilitiesSection">Utilities & Amenities</label>
					<div class="custom-section" id="utilitiesSection">
						<ul class="section-list" id="utilitiesList"></ul>
						<div class="add-section-form">
							<label for="utilityName">Utility/Amenity</label>
							<input type="text" id="utilityName" placeholder="e.g., Electricity, Internet, Water, Parking">
							
							<label for="utilityResponsibility">Responsibility</label>
							<select id="utilityResponsibility">
								<option value="included">Included in main compensation</option>
								<option value="first">Provided by space provider</option>
								<option value="second">Provided by space user</option>
								<option value="split">Split between parties</option>
							</select>
							
							<label for="utilityDetails">Details</label>
							<textarea id="utilityDetails" placeholder="Describe payment details, usage limits, etc..."></textarea>
							
							<button type="button" id="addUtility" class="success">Add Utility/Amenity</button>
						</div>
					</div>
				</div>
				
				<div class="form-section">
					<label for="moveOutProcess">Space Return Process</label>
					<textarea id="moveOutProcess" placeholder="Describe the process for returning the space at arrangement end..."></textarea>
				</div>
				
				<div class="button-group">
					<button class="prev-tab" data-prev="details">Back to Details</button>
					<button class="next-tab" data-next="conditions">Continue to Conditions</button>
				</div>
			`;
			
			// Insert after details tab but before conditions tab content
			const conditionsTabContent = document.getElementById('conditionsTab');
			conditionsTabContent.parentNode.insertBefore(propertyTabContent, conditionsTabContent);
		},
		
		improveTabNavigation: function() {
			// Override the existing tab click handlers
			const tabs = document.querySelectorAll('.tab');
			tabs.forEach(tab => {
				// Remove existing event listeners
				const newTab = tab.cloneNode(true);
				tab.parentNode.replaceChild(newTab, tab);
				
				// Add our new event handler
				newTab.addEventListener('click', () => {
					const tabName = newTab.getAttribute('data-tab');
					
					// Update active tab
					tabs.forEach(t => t.classList.remove('active'));
					newTab.classList.add('active');
					
					// Hide all tab content
					document.querySelectorAll('.tab-content').forEach(content => {
						content.classList.remove('active');
					});
					
					// Show only the active tab content
					document.getElementById(tabName + 'Tab').classList.add('active');
				});
			});
			
			// Also improve the next/prev buttons
			document.querySelectorAll('.next-tab, .prev-tab').forEach(button => {
				// Remove existing event listeners
				const newButton = button.cloneNode(true);
				button.parentNode.replaceChild(newButton, button);
				
				// Add our new event handler
				newButton.addEventListener('click', () => {
					const nextTab = newButton.getAttribute('data-next');
					const prevTab = newButton.getAttribute('data-prev');
					const targetTab = nextTab || prevTab;
					
					if (targetTab) {
						// Simulate a click on the target tab
						document.querySelector(`.tab[data-tab="${targetTab}"]`).click();
					}
				});
			});
		},
		
		initializeEvents: function() {
			// Wait for DOM to be ready with the new elements
			setTimeout(() => {
				// Add tab switching functionality
				document.querySelector('.tab[data-tab="property"]').addEventListener('click', function() {
					// Update active tab
					document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
					this.classList.add('active');
					
					// Show active content
					document.querySelectorAll('.tab-content').forEach(content => {
						content.classList.remove('active');
					});
					document.getElementById('propertyTab').classList.add('active');
				});
				
				// Next/Previous buttons functionality
				document.querySelector('#propertyTab .next-tab').addEventListener('click', function() {
					const nextTab = this.getAttribute('data-next');
					document.querySelector(`.tab[data-tab="${nextTab}"]`).click();
				});
				
				document.querySelector('#propertyTab .prev-tab').addEventListener('click', function() {
					const prevTab = this.getAttribute('data-prev');
					document.querySelector(`.tab[data-tab="${prevTab}"]`).click();
				});
				
				// Show/hide compensation types based on selection
				const compensationTypeSelect = document.getElementById('compensationType');
				const monetaryDetails = document.getElementById('monetaryDetails');
				const workDetails = document.getElementById('workDetails');
				const barterDetails = document.getElementById('barterDetails');
				const mixedDetails = document.getElementById('mixedDetails');
				
				compensationTypeSelect.addEventListener('change', function() {
					// Hide all
					monetaryDetails.classList.add('hidden');
					workDetails.classList.add('hidden');
					barterDetails.classList.add('hidden');
					mixedDetails.classList.add('hidden');
					
					// Show relevant section
					if (this.value === 'monetary') {
						monetaryDetails.classList.remove('hidden');
					} else if (this.value === 'work') {
						workDetails.classList.remove('hidden');
					} else if (this.value === 'barter') {
						barterDetails.classList.remove('hidden');
					} else if (this.value === 'mixed') {
						mixedDetails.classList.remove('hidden');
						monetaryDetails.classList.remove('hidden');
					}
				});
				
				// Add maintenance responsibility
				const maintenanceList = document.getElementById('maintenanceList');
				const addMaintenanceBtn = document.getElementById('addMaintenance');
				
				addMaintenanceBtn.addEventListener('click', function() {
					const item = document.getElementById('maintenanceItem').value;
					const person = document.getElementById('maintenancePerson').value;
					const description = document.getElementById('maintenanceDescription').value;
					
					if (!item || !description) return;
					
					let personText = '';
					if (person === 'first') {
						personText = 'Space Provider';
					} else if (person === 'second') {
						personText = 'Space User';
					} else if (person === 'both') {
						personText = 'Both Parties';
					} else {
						personText = 'Shared';
					}
					
					const li = document.createElement('li');
					li.className = 'section-item';
					li.innerHTML = `
						<strong>${item}</strong> - ${personText}: ${description}
						<div class="section-controls">
							<button class="danger delete-item">Remove</button>
						</div>
					`;
					
					maintenanceList.appendChild(li);
					
					// Reset fields
					document.getElementById('maintenanceItem').value = '';
					document.getElementById('maintenanceDescription').value = '';
					
					// Add delete functionality
					li.querySelector('.delete-item').addEventListener('click', function() {
						li.remove();
					});
				});
				
				// Add utility
				const utilitiesList = document.getElementById('utilitiesList');
				const addUtilityBtn = document.getElementById('addUtility');
				
				addUtilityBtn.addEventListener('click', function() {
					const name = document.getElementById('utilityName').value;
					const responsibility = document.getElementById('utilityResponsibility').value;
					const details = document.getElementById('utilityDetails').value;
					
					if (!name) return;
					
					let responsibilityText = '';
					if (responsibility === 'included') {
						responsibilityText = 'Included in main compensation';
					} else if (responsibility === 'first') {
						responsibilityText = 'Provided by space provider';
					} else if (responsibility === 'second') {
						responsibilityText = 'Provided by space user';
					} else {
						responsibilityText = 'Split between parties';
					}
					
					const li = document.createElement('li');
					li.className = 'section-item';
					li.innerHTML = `
						<strong>${name}</strong> - ${responsibilityText}: ${details || 'No additional details'}
						<div class="section-controls">
							<button class="danger delete-item">Remove</button>
						</div>
					`;
					
					utilitiesList.appendChild(li);
					
					// Reset fields
					document.getElementById('utilityName').value = '';
					document.getElementById('utilityDetails').value = '';
					
					// Add delete functionality
					li.querySelector('.delete-item').addEventListener('click', function() {
						li.remove();
					});
				});
				
				// Extend the generate preview function to include property details
				const originalGeneratePreview = document.getElementById('generatePreview').onclick;
				
				document.getElementById('generatePreview').onclick = function() {
					// Call the original function first
					if (originalGeneratePreview) {
						originalGeneratePreview.call(this);
					}
					
					// Check if property tab exists and has been configured
					if (!document.getElementById('propertyTab')) return;
					
					// Get property details
					const spaceType = document.getElementById('spaceType')?.value || 'Not specified';
					const spaceDescription = document.getElementById('spaceDescription')?.value || 'Not specified';
					const spaceAccess = document.getElementById('spaceAccess')?.value || 'Not specified';
					const compensationType = document.getElementById('compensationType')?.value || 'Not specified';
					
					// Get compensation details based on type
					let compensationDetails = '';
					if (compensationType === 'monetary') {
						const amount = document.getElementById('paymentAmount')?.value || '0';
						const currency = document.getElementById('paymentCurrency')?.value || 'USD';
						const frequency = document.getElementById('paymentFrequency')?.value || 'Not specified';
						const dueDate = document.getElementById('paymentDueDate')?.value || 'Not specified';
						const method = document.getElementById('paymentMethod')?.value || 'Not specified';
						
						compensationDetails = `
							<p><strong>Type:</strong> Monetary</p>
							<p><strong>Amount:</strong> ${amount} ${currency}</p>
							<p><strong>Frequency:</strong> ${frequency}</p>
							<p><strong>Due Date:</strong> ${dueDate}</p>
							<p><strong>Payment Method:</strong> ${method}</p>
						`;
					} else if (compensationType === 'work') {
						const workDesc = document.getElementById('workDescription')?.value || 'Not specified';
						const workHours = document.getElementById('workHours')?.value || 'Not specified';
						
						compensationDetails = `
							<p><strong>Type:</strong> Services/Work Exchange</p>
							<p><strong>Work Description:</strong> ${workDesc}</p>
							<p><strong>Hours/Frequency:</strong> ${workHours}</p>
						`;
					} else if (compensationType === 'barter') {
						const barterDesc = document.getElementById('barterDescription')?.value || 'Not specified';
						
						compensationDetails = `
							<p><strong>Type:</strong> Barter/Trade</p>
							<p><strong>Description:</strong> ${barterDesc}</p>
						`;
					} else if (compensationType === 'mixed') {
						const mixedDesc = document.getElementById('mixedDescription')?.value || 'Not specified';
						
						compensationDetails = `
							<p><strong>Type:</strong> Mixed Arrangement</p>
							<p><strong>Description:</strong> ${mixedDesc}</p>
						`;
					} else if (compensationType === 'free') {
						compensationDetails = `
							<p><strong>Type:</strong> No Compensation Required</p>
						`;
					}
					
					// Get maintenance responsibilities
					let maintenanceHtml = '';
					document.querySelectorAll('#maintenanceList .section-item').forEach(item => {
						maintenanceHtml += `<li>${item.innerHTML.split('<div')[0]}</li>`;
					});
					
					// Get utilities
					let utilitiesHtml = '';
					document.querySelectorAll('#utilitiesList .section-item').forEach(item => {
						utilitiesHtml += `<li>${item.innerHTML.split('<div')[0]}</li>`;
					});
					
					// Get other property details
					const housingRules = document.getElementById('housingRules')?.value || 'Not specified';
					const visitorsPolicy = document.getElementById('visitorsPolicy')?.value || 'Not specified';
					const moveOutProcess = document.getElementById('moveOutProcess')?.value || 'Not specified';
					
					// Create space sharing section HTML
					const propertyHtml = `
						<h2>Space Sharing Details</h2>
						
						<h3>Space Information</h3>
						<p><strong>Type:</strong> ${spaceType}</p>
						<p><strong>Description:</strong> ${spaceDescription}</p>
						<p><strong>Access Details:</strong> ${spaceAccess}</p>
						
						<h3>Compensation Arrangement</h3>
						${compensationDetails}
						
						<h3>Upkeep Responsibilities</h3>
						${maintenanceHtml ? `<ul>${maintenanceHtml}</ul>` : '<p>No maintenance responsibilities specified</p>'}
						
						<h3>Space Usage Guidelines</h3>
						<p>${housingRules}</p>
						
						<h3>Visitors Policy</h3>
						<p>${visitorsPolicy}</p>
						
						<h3>Utilities & Amenities</h3>
						${utilitiesHtml ? `<ul>${utilitiesHtml}</ul>` : '<p>No utilities specified</p>'}
						
						<h3>Space Return Process</h3>
						<p>${moveOutProcess}</p>
					`;
					
					// Find where to insert the property HTML in the agreement output
					const agreementOutput = document.getElementById('agreementOutput');
					if (!agreementOutput) return;
					
					// Create a temporary element to hold the property HTML
					const tempDiv = document.createElement('div');
					tempDiv.innerHTML = propertyHtml;
					
					// Find the responsibilities section to insert before
					const responsibilitiesHeader = Array.from(agreementOutput.querySelectorAll('h2')).find(h => 
						h.textContent === 'Responsibilities'
					);
					
					// Insert before responsibilities section
					if (responsibilitiesHeader) {
						agreementOutput.insertBefore(tempDiv, responsibilitiesHeader);
					} else {
						// If no responsibilities header, append to the end before signatures
						const signatureSection = agreementOutput.querySelector('div[style*="margin-top: 50px"]');
						if (signatureSection) {
							agreementOutput.insertBefore(tempDiv, signatureSection);
						} else {
							// As a last resort, append to the end
							agreementOutput.appendChild(tempDiv);
						}
					}
				};
			}, 100);
		}
	};

	// Helper function to find elements by text content (since we don't have jQuery)
	Element.prototype.textContentContains = function(text) {
		return this.textContent.indexOf(text) !== -1;
	};

	// Initialize the Property Sharing Module
	document.addEventListener('DOMContentLoaded', function() {
		setTimeout(() => {
			PropertySharingModule.initialize();
		}, 500);
	});
	</script>
	
</body>
</html>